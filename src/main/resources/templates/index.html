<!DOCTYPE html >
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity5">
<head th:fragment="head">
  <meta charset="utf-8">
  <title>FollowT</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="keywords" content="">
  <meta name="description" content="涛哥商城">
  <link rel="stylesheet" href="../res/layui/css/layui.css">
  <link rel="stylesheet" href="../res/css/global.css">
  <link rel="stylesheet" href="/res/css/common.css">
  <link rel="stylesheet" href="/res/css/m.css">
  <link rel="stylesheet" href="/res/css/kk.css">
</head>
<style>


</style>
<body>

<div class="fly-header layui-bg-black" th:fragment="header">
<div class="layui-container" >
	<ul class="layui-nav  " >
	  <li class="layui-nav-item" id="1">
		<a href="/index" style="cursor:pointer">商城主页</a>
	  </li>
	  <li class="layui-nav-item layui-hide-xs" id="2">
		<a href="javascript:;" style="cursor:pointer">我的商城</a>
		<dl class="layui-nav-child">
	      <dd><a href="/history">浏览历史</a></dd>
	      <dd><a href="/">我的订单</a></dd>
	    </dl>
	  </li>
	  <li class="layui-nav-item layui-hide-xs" id="3">
		<a href="/trolley" style="cursor:pointer" >购物车</span></a>
	  </li>
	  <li class="layui-nav-item layui-hide-xs">
		<a href="/registershop" style="cursor:pointer"> 卖家中心</a>
	  </li>
	  <li class="layui-nav-item layui-hide-xs">
		<a style="cursor:hand"> 商品</a>
	  </li>
	  <!--  <li style="cursor:hand"class="layui-nav-item layui-hide-xs">
		<a >不接受所有的不欢而散</a>
	  </li>-->
	  <span id="index" style="left: 0px;top: 55px;width: 96px;height: 5px;opacity: 1; display:none; background-color: #5FB878; position: absolute ;"></span>
	  <span id="my" style="left: 96px;top: 55px;width: 96px;height: 5px;opacity: 1; display:none; background-color: #5FB878; position: absolute ;"></span>
	  <span id="trolley" style="left: 192px;top: 55px;width: 96px;height: 5px;opacity: 1; display:none; background-color: #5FB878; position: absolute ;"></span>
	  <span id="regStore" style="left: 288px;top: 55px;width: 80px;height: 5px;opacity: 1; display:none; background-color: #5FB878; position: absolute ;"></span>
	  <span id="commodity" style="left: 384px;top: 55px;width: 50px;height: 5px;opacity: 1; display:none; background-color: #5FB878; position: absolute ;"></span>
	  
	</ul>

	
	<ul class="layui-nav layui-hide-xs"  style="position: absolute;top: 0;right: 100px;" sec:authorize="isAuthenticated()">
		<li class="layui-nav-item" lay-unselect="">		
			<marquee scrollamount=4 align=# width="100px">hi,欢迎来到涛哥商城</marquee>
	    </li>	
	</ul>
	<ul class="layui-nav"  style="position: absolute;top: 0;right: 0;" id="my" sec:authorize="isAnonymous()">
		<li class="layui-nav-item" lay-unselect="">
		<li class="layui-nav-item" lay-unselect="">		
			<a href="/login">登入</a>
	    </li>
	    <li class="layui-nav-item" lay-unselect="">		
			<a href="/reg">注册</a>
	    </li>
	    <li class="layui-nav-item" lay-unselect="">		
			<a href="https://graph.qq.com/oauth2.0/authorize?response_type=code&client_id=101579436&redirect_uri=http://www.followt.xin/qqLogin&state=test" onclick="layer.msg('正在通过QQ登入', {icon:16, shade: 0.1, time:0})" title="QQ登入" class="iconfont icon-qq"></a>
	    </li>
	</ul>
	<ul class="layui-nav"  style="position: absolute;top: 0;right: 0;" id="my" sec:authorize="isAuthenticated()">
		<li class="layui-nav-item" lay-unselect="">
		<a href="javascript:;"><img th:src="${#authentication.principal.avatar} == null ? 'https://get-blog.oss-cn-shanghai.aliyuncs.com/senlear/user/945614282%40qq.com/files/wx.jpg' : ${#authentication.principal.avatar}" alt="Tg" class="layui-nav-img">我</a>
		<dl class="layui-nav-child">
		  <dd th:if="${hasStore}"><a href="/store" th:href="'/store/'+${storeid}">我的店铺</a></dd>
		  <dd><a href="/history">历史浏览</a></dd>
		  <dd><a href="/trolley">我的购物车</a></dd>
		  <dd><a href="/logout">退出登录</a></dd>
		</dl>
		</li>	
		<span id="bar" style="left: 0px;top: 55px;width: 96px;height: 5px;opacity: 1; display:none; background-color: #5FB878; position: absolute ;"></span>
	</ul>
</div>
</div>




<div class="layui-container" style="margin-top:7.5px; display:block" id="content">
  <div class="container">
    <form  class="parent" th:replace="~{search::search}">
    </form>
</div>
  <div class="layui-row layui-col-space15">
    <div class="layui-col-md9 "> 
    	<div  class="layui-col-md12">
    		<div class="layui-col-md8 ">
        	<div  class="layui-carousel " style="float:left" id="test10" >
				<div carousel-item="" >
				<div ><img src="https://get-blog.oss-cn-shanghai.aliyuncs.com/senlear/user/945614282%40qq.com/files/2.png" style="width:100%;height:100%"></div>
				<div ><img src="https://get-blog.oss-cn-shanghai.aliyuncs.com/senlear/user/945614282%40qq.com/files/3.png" style="width:100%;height:100%"></div>
				<div ><img src="https://get-blog.oss-cn-shanghai.aliyuncs.com/senlear/user/945614282%40qq.com/files/4.png" style="width:100%;height:100%"></div>
				<div ><img src="https://get-blog.oss-cn-shanghai.aliyuncs.com/senlear/user/945614282%40qq.com/files/5.png" style="width:100%;height:100%"></div>
				</div>			
			</div>
			</div>
	 		<div class="headline  layui-col-md3">
      			<ul>
        		<li><a  title="比篮球更重要的就是你啦"><img src="https://timgsa.baidu.com/timg?image&quality=80&size=b9999_10000&sec=1558277808036&di=94f3a11714029b89d5c56bf545e29fe6&imgtype=0&src=http%3A%2F%2Fgss0.baidu.com%2F94o3dSag_xI4khGko9WTAnF6hhy%2Fzhidao%2Fpic%2Fitem%2F4610b912c8fcc3ce339d25749345d688d43f201c.jpg" alt="比篮球更重要的就是你啦"><span>比篮球更重要的就是你啦</span></a></li>
        		<li><a  title="老詹牛逼"><img src="https://get-blog.oss-cn-shanghai.aliyuncs.com/senlear/user/945614282%40qq.com/files/7.png" alt="不接受所有的不欢而散"><span></span></a></li>
     			</ul>
    		</div> 
    	</div> 
    	<div class="fly-panel" id="article" >
    		<div class="fly-panel-title fly-filter" th:fragment="type">
          		<span class="layui-breadcrumb" lay-separator="|">
  					<a id="all" href="/index?type=all">全部</a>
  					<a id="clothes" href="/index?type=clothes">潮衣</a>
  					<a id="pants" href="/index?type=pants">潮裤</a>
  					<a id="shoes" href="/index?type=shoes">潮鞋</a>
  					<a id="cars" href="/index?type=cars">潮车</a>
  					<a id="computers" href="/index?type=computers">电脑</a>
  					<a id="watches" href="/index?type=watches">手表</a>
				</span>
        	</div>
        	<ul class="flow-default" style="height: auto;" id="LAY"></ul>
        	
    	</div>
    	
     </div>
    <div class="layui-col-md3" th:fragment="recommend">

      <div class="fly-panel">
        <h3 class="fly-panel-title">热门店铺</h3>
        <ul class="fly-panel-main fly-list-static" th:each="store :${hotStores}">
          <li>
            <a  target="_blank" th:text="${store.storename}" th:href="'/store/'+${store.id}"></a>
          </li>
        </ul>
      </div>
	   <div class="fly-panel">
        <div class="fly-panel-title">
         热门商品
        </div>
        <div class="fly-panel-main" style="background-color: #5FB878;" th:each="hotCommodity :${hotCommodities}">
          <a target="_blank" style="background-color: #5FB878;color: #fff" th:text="${hotCommodity.commodityname}" th:href="'/commodity/'+${hotCommodity.id}"></a><br><br>
        </div>
      </div>

      <div class="fly-panel" style="padding: 20px 0; text-align: center;">
        <img src="https://get-blog.oss-cn-shanghai.aliyuncs.com/wentaohome/weixin.png" style="max-width: 100%;" alt="tg">
        <p style="position: relative; color: #666;">微信扫码获取更多</p>
      </div>
    </div>
  </div>
</div>
<div class="fly-footer" th:fragment="footer">
  <p><a href="http://followt.xin/" target="_blank">Senlear社区</a> 2019 &copy; <a href="http://followt.xin/" target="_blank">learn more</a></p>
  <p>
    <a href="https://get-blog.oss-cn-shanghai.aliyuncs.com/wentaohome/weixin.png" target="_blank">一元也是爱</a>
    <a href="https://github.com/Follow-T/Senlear-" target="_blank">获取Senlear社区Github地址</a>
    <a href="https://get-blog.oss-cn-shanghai.aliyuncs.com/wentaohome/mmqrcode1556891308185.png" target="_blank">微信号</a>
  </p>
</div>
 
<script src="../res/layui/layui.js"></script>
<script src="/res/Jquery.js"></script>
<script src="../res/js/index.js"></script>
<script>
layui.cache.page = '';
layui.cache.user = {
  username: '游客'
  ,uid: -1
  ,avatar: '../res/images/avatar/00.jpg'
  ,experience: 83
  ,sex: '男'
};
layui.config({
  version: "3.0.0"
  ,base: '../res/mods/' //这里实际使用时，建议改成绝对路径
}).extend({
  fly: 'index'
}).use('fly');
</script>
<script>
layui.use(['carousel', 'form','flow','element'], function(){
  var carousel = layui.carousel;
  var form = layui.form;
  var flow = layui.flow;
  var element = layui.element;
  var startIndex=0;
  var displayLength=12;
  var pageSize='[[${page}]]';
  //监听导航点击
  element.on('nav(demo)', function(elem){
    //console.log(elem)
    layer.msg(elem.text());
  });
  
  //图片轮播
  carousel.render({
    elem: '#test10'
    ,width: '100%'
    ,height: '260px'
    ,interval: 5000
  });
  
  //流布局
  flow.load({
	    elem: '#LAY' //流加载容器
	    ,scrollElem: '#LAY' //滚动条所在元素，一般不用填，此处只是演示需要。
	    ,isAuto: false
	    ,isLazyimg: true
	    ,done: function(page, next){ //加载下一页
	      //模拟插入
	      setTimeout(function(){
	        var lis = [];
	        var length=0;
	        var formData = new FormData();
	        formData.append("startIndex",Number(startIndex));
	        formData.append("displayLength",Number(displayLength));
	        formData.append("type",getType());
	        $.ajax({
	            url: '/index/commodities',
	            type: 'POST',
	            data: formData,
	            //这两个设置项必填
	            contentType: false,
	            processData: false,
	            dataType: 'jsonp',
	            calback: "callback",
	            cache: false,
	            success: function (data) {
	            	if(data['status']=="200"){
	            		var commodities=JSON.parse(data['data']);
	            		length=commodities.length;
	            		for(var i = 0; i < length; i++){
	        	        	lis.push('<li ><a href="/commodity/'+commodities[i]['id']+'"><img src='+commodities[i]['picture']+'>'+commodities[i]['commodityname']+'</a></li>')
	        	        }
	            		startIndex+=startIndex;
	        	        next(lis.join(''), page < pageSize); 
	            	}else{
	            		layer.msg(data['data']);
	            	}		
	            },
	            error: function (XMLHttpRequest, textStatus, errorThrown) {
	            	 layer.msg('网络错误!',{icon:2,time:1000});
	            }
	      	});
	      }, 500);
	    }
	  });
  //获取type
  function getType(){
	  var url=window.location.href;
	  var type;
	  if(url.search("=")==-1){
	  	type="all";
	  }else{
	  	type=url.split("=")[1];
	  }
	  if(type=="clothes"){
		  type="1";
	  }else if(type=="pants"){
		  type="2";
	  }else if(type=="shoes"){
		  type="3";
	  }else if(type=="cars"){
		  type="4";
	  }else if(type=="computers"){
		  type="5";
	  }else if(type=="watches"){
		  type="6";
	  }else{
		  type="all";
	  }
	  return type;
  }
  
//搜索商品
  $('#search').click(function(){
 	  var searchText=$('#searchText').val();
 	  if(searchText==""){
 		  layer.msg("搜索的商品不能为空！",{icon:2,time:1000});
 		  return;
 	  }
 	  window.location.href="/search?commodityname="+searchText;
   })
});
</script>
</body>
</html>